#!/usr/bin/env bash
PACK="$HOME/.config/nvim/pack/plugins/start/"
PLUGINS=(
  "neovim/nvim-lspconfig"
  "akinsho/toggleterm.nvim"
  "hrsh7th/nvim-cmp"
  "hrsh7th/cmp-nvim-lsp"
  "vim-airline/vim-airline"
  "petertriho/nvim-scrollbar"
)

_plugins() {
  local bname url dest
  for url in "${PLUGINS[@]}"; do
    bname=$(basename "$url")
    echo "========="
    echo "$bname"
    echo "========="
    dest="$PACK/$bname"
    if [ ! -d "$dest" ]; then
      if ! git clone "https://github.com/$url" "$dest" --single-branch; then
        echo "unable to clone"
        exit 1
      fi
    else
      if ! git -C "$dest" pull origin "$(git -C "$dest" rev-parse --abbrev-ref HEAD)"; then
        echo "failed to pull updates"
        exit 1
      fi
    fi
  done
}

_plugins
