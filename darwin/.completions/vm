#compdef _vm vm
 
_vm() { 
  local curcontext="$curcontext" state len
  typeset -A opt_args

  _arguments \
    '1: :->main'\
    '*: :->args'

  len=${#words[@]}
  case $state in
    main)
      _arguments '1:main:(start status stop attach ls)'
    ;;
    *)
      case $words[2] in
        "status" | "start" | "stop" | "attach")
          compadd "$@" $(vm ls)
        ;;
      esac
  esac
}
