#!/bin/sh
if ! which brew >/dev/null; then
  echo "no brew installed here"
  exit 1
fi
CACHE="$HOME/Library/voidedtech/brew"
mkdir -p "$CACHE"
for CMD in update upgrade; do
  if ! brew "$CMD"; then
    echo "brew $CMD failed!"
    exit 1
  fi
done
rm -f "$CACHE/Brewfile"
if ! (cd "$CACHE" && brew bundle dump); then
  echo "failed to dump brew definitions"
  exit 1
fi
