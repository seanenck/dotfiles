applications:
  rclone:
    source:
      github:
        project: "rclone/rclone"
        release:
          asset: "rclone-(.+?)-osx-arm64.zip"
  blap:
    source:
      github:
        project: "seanenck/blap"
        release:
          asset: "tarball"
    commands:
      steps:
        - command: ["just", "version={{ $.Vars.Tag }}"]
        - command: ["/bin/sh", "-c", "target/blap completions > $COMPLETIONS/blap.bash"]
        - command: ["ln", "-sf", "{{ $.Vars.Directory}}/target/blap", "$DESTDIR/blap"]
  shellcheck:
    source:
      github:
        project: "koalaman/shellcheck"
        release:
          asset: '{{ $.OS }}.{{ if eq $.Arch "amd64" }}x86_64{{ end }}.tar.xz$'
    commands:
      steps:
        - command: ["ln", "-sf", "{{ $.Vars.Directory}}/shellcheck", "$DESTDIR/shellcheck"]
  efm:
    source:
      github:
        project: "mattn/efm-langserver"
        release:
          asset: "tarball"
    commands:
      steps:
        - command: ["go", "build", "-ldflags", "-X main.revision={{ $.Vars.Tag }}", "-o", "efm-langserver", "."]
        - command: ["ln", "-sf", "{{ $.Vars.Directory}}/efm-langserver", "$DESTDIR/efm-langserver"]
  gittools:
    source:
      github:
        project: "seanenck/git-tools"
        branch:
          name: "master"
    commands:
      steps:
        - command: ["just"]
        - command: ["ln", "-sf", "{{ $.Vars.Directory}}/git-uncommitted", "$DESTDIR/git-uncommitted"]
        - command: ["ln", "-sf", "{{ $.Vars.Directory}}/git-current-state", "$DESTDIR/git-current-state"]
