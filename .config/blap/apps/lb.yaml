applications:
  lb:
    source:
      github:
        project: "seanenck/lockbox"
        release:
          asset: "tarball"
    build:
      steps:
        - command: ["just", "version={{ $.Vars.Tag }}"]
        - command: ["/bin/sh", "-c", "target/lb completions > target/lb.bash"]
    deploy:
      artifacts:
        - files:
            - "target/lb"
          destination: "~/.local/bin/"
        - files:
            - "target/lb.bash"
          destination: "~/.config/shellrc/completions/"
  age:
    source:
      github:
        project: "FiloSottile/age"
        release:
          asset: "tarball"
    build:
      steps:
        - command: ["go", "build", "-trimpath", "-buildmode=pie", "-mod=readonly", "-modcacherw", "-ldflags", "-X main.Version={{ $.Vars.Tag }} -linkmode external", "-o", ".", "./..."]
    deploy:
      artifacts:
        - files:
            - "age"
            - "age-keygen"
          destination: "~/.local/bin"
