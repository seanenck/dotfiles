#!/usr/bin/env bash
CACHE=$HOME/.cache/gitcc
OVERRIDE=$HOME/.env/local/lib/git/
mkdir -p $CACHE
if [ -z "$1" ]; then
    echo "remote required"
    exit 1
fi
OVERRIDE=$OVERRIDE$(echo $1 | cut -d ":" -f 1)
CLONE=$1
CONFIG=""
if [ -d $OVERRIDE ]; then
    CLONE=$(cat $OVERRIDE/url)$(echo "$1" | cut -d ":" -f 2-)
    CONFIG=$OVERRIDE/config
    if [ ! -e $CONFIG ]; then
        CONFIG=""
    fi
fi
NAME=$(basename $1 | rev | cut -d ":" -f 1 | rev)
git clone "$CLONE" $NAME
if [ -n "$CONFIG" ]; then
    cat $CONFIG >> $NAME/.git/config
fi
