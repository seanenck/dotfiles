#!/bin/bash
_is-muted() {
    local ismuted
    ismuted=$(pactl get-source-mute @DEFAULT_SOURCE@)
    if echo "$ismuted" | grep -q "Mute: yes"; then
        echo "yes"
    else
        if echo "$ismuted" | grep -q "Mute: no"; then
            echo "no"
        else
            echo "unknown"
        fi
    fi
}

if [ -z "$1" ]; then
    echo "command required"
    exit 1
fi

state=$(_is-muted)
if [[ "$state" == "unknown" ]]; then
    echo "state unknown"
    exit 1
fi
cmd=""
case "$1" in
    "mute")
        cmd="yes"
        ;;
    "unmute")
        cmd="no"
        ;;
    "toggle")
        cmd="toggle"
        ;;
    *)
        echo "unknown command: $1"
        exit 1
        ;;
esac
pactl set-source-mute @DEFAULT_SOURCE@ $cmd
